const obj = [
  {
    active: false,
    id: 33544886,
    syncStatus: 'Exported',
    summary: null,
    referenceNumber: '',
    invoiceDate: '1900-01-01T00:00:00Z',
    dueDate: '1900-01-01T00:00:00Z',
    subTotal: '0.00',
    salesTax: '0.00',
    salesTaxCode: null,
    total: '0.00',
    balance: '0.00',
    invoiceType: null,
    customer: { id: 32170776, name: 'ADDINGTON PLACE' },
    customerAddress: {
      street: '42102 SEVEN MILE RD.',
      unit: '',
      city: 'NORTHVILLE, MI',
      state: null,
      zip: '48167',
      country: null
    },
    location: { id: 32271756, name: 'ADDINGTON PLACE' },
    locationAddress: {
      street: '42102 SEVEN MILE RD.',
      unit: '',
      city: 'NORTHVILLE, MI',
      state: null,
      zip: '48167',
      country: null
    },
    businessUnit: { id: 1034881, name: '60EXP-Comm Service' },
    termName: 'Due Upon Receipt',
    createdBy: null,
    batch: null,
    depositedOn: null,
    createdOn: '1951-01-01T00:00:00Z',
    modifiedOn: '2022-07-11T23:37:04.33Z',
    adjustmentToId: null,
    job: { id: 32407039, number: '0004137', type: 'Imported JobType' },
    projectId: null,
    royalty: { status: 'Pending', date: null, sentOn: null, memo: null },
    employeeInfo: null,
    commissionEligibilityDate: null,
    items: null,
    customFields: null
  },
  {
    active: true,
    id: 33544887,
    syncStatus: 'Exported',
    summary: null,
    referenceNumber: '',
    invoiceDate: '1900-01-01T00:00:00Z',
    dueDate: '1900-01-01T00:00:00Z',
    subTotal: '0.00',
    salesTax: '0.00',
    salesTaxCode: null,
    total: '0.00',
    balance: '0.00',
    invoiceType: null,
    customer: { id: 32170776, name: 'ADDINGTON PLACE' },
    customerAddress: {
      street: '42102 SEVEN MILE RD.',
      unit: '',
      city: 'NORTHVILLE, MI',
      state: null,
      zip: '48167',
      country: null
    },
    location: { id: 32271756, name: 'ADDINGTON PLACE' },
    locationAddress: {
      street: '42102 SEVEN MILE RD.',
      unit: '',
      city: 'NORTHVILLE, MI',
      state: null,
      zip: '48167',
      country: null
    },
    businessUnit: { id: 1034881, name: '60EXP-Comm Service' },
    termName: 'Due Upon Receipt',
    createdBy: null,
    batch: null,
    depositedOn: null,
    createdOn: '1951-01-01T00:00:00Z',
    modifiedOn: '2022-07-11T23:37:04.33Z',
    adjustmentToId: null,
    job: { id: 32407040, number: '0004137', type: 'Imported JobType' },
    projectId: null,
    royalty: { status: 'Pending', date: null, sentOn: null, memo: null },
    employeeInfo: null,
    commissionEligibilityDate: null,
    items: null,
    customFields: null
  },
  {
    active: true,
    id: 33544888,
    syncStatus: 'Exported',
    summary: null,
    referenceNumber: '',
    invoiceDate: '1900-01-01T00:00:00Z',
    dueDate: '1900-01-01T00:00:00Z',
    subTotal: '0.00',
    salesTax: '0.00',
    salesTaxCode: null,
    total: '0.00',
    balance: '0.00',
    invoiceType: null,
    customer: { id: 32208394, name: 'NCS CONSTRUCTION-MAIN OFFICE' },
    customerAddress: {
      street: '876 Horace Brown Drive',
      unit: null,
      city: 'Madison Heights',
      state: 'MI',
      zip: '48071',
      country: 'USA'
    },
    location: { id: 32229352, name: 'ZOYO YOGORT' },
    locationAddress: {
      street: '3067 ROCHESTER RD.',
      unit: '',
      city: 'TROY, MI',
      state: null,
      zip: '48063',
      country: null
    },
    businessUnit: { id: 1034881, name: '60EXP-Comm Service' },
    termName: 'Due Upon Receipt',
    createdBy: null,
    batch: null,
    depositedOn: null,
    createdOn: '1951-01-01T00:00:00Z',
    modifiedOn: '2022-07-11T23:37:04.33Z',
    adjustmentToId: null,
    job: { id: 32407041, number: '0004201', type: 'Imported JobType' },
    projectId: null,
    royalty: { status: 'Pending', date: null, sentOn: null, memo: null },
    employeeInfo: null,
    commissionEligibilityDate: null,
    items: null,
    customFields: null
  },
  {
    active: false,
    id: 33544889,
    syncStatus: 'Exported',
    summary: null,
    referenceNumber: '',
    invoiceDate: '1900-01-01T00:00:00Z',
    dueDate: '1900-01-01T00:00:00Z',
    subTotal: '0.00',
    salesTax: '0.00',
    salesTaxCode: null,
    total: '0.00',
    balance: '0.00',
    invoiceType: null,
    customer: { id: 32208394, name: 'NCS CONSTRUCTION-MAIN OFFICE' },
    customerAddress: {
      street: '876 Horace Brown Drive',
      unit: null,
      city: 'Madison Heights',
      state: 'MI',
      zip: '48071',
      country: 'USA'
    },
    location: { id: 32229352, name: 'ZOYO YOGORT' },
    locationAddress: {
      street: '3067 ROCHESTER RD.',
      unit: '',
      city: 'TROY, MI',
      state: null,
      zip: '48063',
      country: null
    },
    businessUnit: { id: 1034881, name: '60EXP-Comm Service' },
    termName: 'Due Upon Receipt',
    createdBy: null,
    batch: null,
    depositedOn: null,
    createdOn: '1951-01-01T00:00:00Z',
    modifiedOn: '2022-07-11T23:37:04.33Z',
    adjustmentToId: null,
    job: { id: 32407042, number: '0004201', type: 'Imported JobType' },
    projectId: null,
    royalty: { status: 'Pending', date: null, sentOn: null, memo: null },
    employeeInfo: null,
    commissionEligibilityDate: null,
    items: null,
    customFields: null
  },
  {
    active: false,
    id: 33544890,
    syncStatus: 'Exported',
    summary: null,
    referenceNumber: '',
    invoiceDate: '1900-01-01T00:00:00Z',
    dueDate: '1900-01-01T00:00:00Z',
    subTotal: '0.00',
    salesTax: '0.00',
    salesTaxCode: null,
    total: '0.00',
    balance: '0.00',
    invoiceType: null,
    customer: { id: 32179281, name: 'CMAC TRANSPORTATION' },
    customerAddress: {
      street: '20450 Sibley Road',
      unit: null,
      city: 'Brownstown Charter Township',
      state: 'MI',
      zip: '48193',
      country: 'USA'
    },
    location: { id: 32272174, name: 'CMAC TRANSPORTATION' },
    locationAddress: {
      street: '20450 Sibley Road',
      unit: null,
      city: 'Brownstown Charter Township',
      state: 'MI',
      zip: '48193',
      country: 'USA'
    },
    businessUnit: { id: 1034881, name: '60EXP-Comm Service' },
    termName: 'Due Upon Receipt',
    createdBy: null,
    batch: null,
    depositedOn: null,
    createdOn: '1951-01-01T00:00:00Z',
    modifiedOn: '2022-07-11T23:37:04.33Z',
    adjustmentToId: null,
    job: { id: 32407043, number: '0004218', type: 'Imported JobType' },
    projectId: null,
    royalty: { status: 'Pending', date: null, sentOn: null, memo: null },
    employeeInfo: null,
    commissionEligibilityDate: null,
    items: null,
    customFields: null
  }
]

// Function to flatten a nested object without any separator
function flattenObject(obj, parentKey = '') {
  let result = {};
  for (const key in obj) {
    if (typeof obj[key] === 'object' && obj[key] !== null) {
      const flattened = flattenObject(obj[key], parentKey + key);
      result = { ...result, ...flattened };
    } else {
      result[parentKey + key] = obj[key];
    }
  }
  return result;
}

const tableName = 'your_table_name'; // Replace with your table name

// Generate SQL statements to create the table
const sampleObj = obj[0]; // Take a sample object to infer the table structure
const flattenedSampleObj = flattenObject(sampleObj);

const createTableSQL = `CREATE TABLE IF NOT EXISTS ${tableName} (
  ${Object.keys(flattenedSampleObj).map(key => `${key} TEXT`).join(',\n  ')}
);`;

console.log(createTableSQL);

console.log('=============================================================================================================================================================================================================================')

// Generate SQL statements to insert data
obj.forEach((currentObj, index) => {
  const flattenedObj = flattenObject(currentObj);

  const insertDataSQL = `INSERT INTO ${tableName} (${Object.keys(flattenedObj).join(', ')})
  VALUES (${Object.values(flattenedObj).map(value => `'${value}'`).join(', ')});`;

  console.log(insertDataSQL);
  console.log('=============================================================================================================================================================================================================================')
});
